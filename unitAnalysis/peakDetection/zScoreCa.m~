function [caz] = zScoreCa(ca)

% Clay Sep.2019
% Zscore based upon relatively quiet epochs in unit calcium signal
% - find times just before events
% - take mean and std for these
% - pick epochs with low mean and std (but not zero! because sometimes NMF
% produces zeros)
% - average these epoch mean/std and use these for Zscoring


fps = 15;

[pks] = clayCaTransients(ca,fps); % detect transients

% find mean/std for epochs just before transients
for i=1:length(pks)
    epochCa = ca(pks(i)-299:pks(i)-100);
    epochMean(i) = mean(epochCa);
    epochStd(i) = std(epochCa);
end

% throw out epochs with std=0 (only happens in weird cases)
epochStd = epochStd(epochStd~=0);
epochMean = epochMean(epochStd~=0);

[N, edges, bin] = histcounts(epochStd, 10);

lowBinEpochs = find(bin==1);



